# MCP Playwright 仓库管理页面列表排序功能测试

## 🚨 统一错误处理策略

**任何MCP命令失败时，自动执行以下操作**：

### 标准错误处理流程：
1. **立即截图**
   ```javascript
   mcp__playwright__browser_take_screenshot({
     filename: './error/{失败步骤}_{时间戳}.png'
   })
   ```

2. **收集错误信息**
   ```javascript
   mcp__playwright__browser_console_messages()
   ```

3. **记录错误** (复制以下模板填写)
   ```
   ❌ 错误报告
   失败步骤：[哪一步失败了]
   错误现象：[看到什么页面/状态]
   错误信息：[MCP返回的具体错误文本]
   截图路径：[./error/文件名.png]
   时间：[发生时间]
   ```

---

## 前置条件

- 系统已有成功登录记录，可参考：`../00_warehouse_template.md`
- 登录凭据信息: 用户名 `adminstrator`，密码 `654321`，验证码 `1`
- 系统服务状态: 后端 `http://localhost:8088`，前端 `http://localhost:9528`
- 目标页面: `http://localhost:9528/#/master/warehouse`
- **数据要求**: 仓库列表至少包含10条以上不同类型的数据记录

## 测试目标

**验证仓库管理页面数据表格的排序功能**：
- 所有可排序列的升序/降序功能
- 排序指示器的正确显示
- 排序后数据的准确性和完整性
- 多次排序操作的稳定性

---

## 测试步骤

### 第一阶段：基础环境确认

**⚠️ 重要前置条件**: 
必须先完整执行基础测试，确保：
- ✅ 登录成功
- ✅ 仓库管理页面正常加载  
- ✅ 数据表格显示完整，记录数量≥10条

```javascript
// 1. 确认当前页面状态
mcp__playwright__browser_snapshot()
```
**预期**: 当前页面应该已经在 `http://localhost:9528/#/master/warehouse`，显示仓库管理页面

```javascript
// 2. 记录初始数据状态
mcp__playwright__browser_console_messages()
```

**🛑 排序测试前置检查**：
- **页面标题正确** - 包含"仓库管理"
- **数据表格加载完成** - 显示仓库数据列表
- **数据量充足** - 至少10条记录用于排序验证
- **列标题可见** - 所有排序相关列标题正常显示

**✅ 只有确认所有前置条件正常，才继续排序测试**

---

### 第二阶段：可排序列识别和基础排序测试

**📋 执行条件**: 第一阶段验证全部通过，数据表格正常显示

基于数据表格结构，开始系统性的排序功能测试。

---

## A. 主要业务列排序测试

### A1. 仓库编码列排序测试

**测试目标**: 验证仓库编码列的字母数字排序功能

```javascript
// 记录排序前的第一条和最后一条数据
mcp__playwright__browser_snapshot()
```
**验证基线**: 记录当前数据顺序作为对比基准

```javascript
// 点击仓库编码列标题进行升序排序
mcp__playwright__browser_click({
  element: '仓库编码列标题',
  ref: 'e1123'
})
```
**预期**: 触发升序排序，显示排序指示器

```javascript
mcp__playwright__browser_wait_for({ time: 2 })
mcp__playwright__browser_snapshot()
```
**验证点**:
- 列标题显示升序指示器（箭头向上）
- 数据按仓库编码字母数字升序排列
- 第一行数据的仓库编码应为最小值
- 数据总量保持不变

```javascript
// 再次点击进行降序排序
mcp__playwright__browser_click({
  element: '仓库编码列标题',
  ref: 'e1123'
})
```
**预期**: 切换到降序排序

```javascript
mcp__playwright__browser_wait_for({ time: 2 })
mcp__playwright__browser_snapshot()
```
**验证点**:
- 列标题显示降序指示器（箭头向下）
- 数据按仓库编码字母数字降序排列
- 第一行数据的仓库编码应为最大值
- 数据完整性保持一致

### A2. 仓库名称列排序测试

**测试目标**: 验证仓库名称列的中文排序功能

```javascript
// 点击仓库名称列标题进行排序
mcp__playwright__browser_click({
  element: '仓库名称列标题',
  ref: 'e1128'
})
```
**预期**: 按仓库名称进行排序（中文字符排序）

```javascript
mcp__playwright__browser_wait_for({ time: 2 })
mcp__playwright__browser_snapshot()
```
**验证点**:
- 中文名称排序规则正确应用
- 排序指示器正确显示
- 原仓库编码列排序指示器应清除

```javascript
// 再次点击测试降序
mcp__playwright__browser_click({
  element: '仓库名称列标题',
  ref: 'e1128'
})
```

```javascript
mcp__playwright__browser_wait_for({ time: 2 })
mcp__playwright__browser_snapshot()
```
**验证**: 名称降序排列正确

### A3. 仓库简称列排序测试

```javascript
// 点击仓库简称列标题
mcp__playwright__browser_click({
  element: '仓库简称列标题',
  ref: 'e1133'
})
```

```javascript
mcp__playwright__browser_wait_for({ time: 2 })
mcp__playwright__browser_snapshot()
```
**验证**: 仓库简称升序排序正确

---

## B. 企业信息列排序测试

### B1. 监管企业列排序测试

```javascript
// 点击监管企业列标题
mcp__playwright__browser_click({
  element: '监管企业列标题',
  ref: 'e1140'
})
```

```javascript
mcp__playwright__browser_wait_for({ time: 2 })
mcp__playwright__browser_snapshot()
```
**验证**: 监管企业信息排序，处理空值显示

### B2. 运营企业列排序测试

```javascript
// 点击运营企业列标题
mcp__playwright__browser_click({
  element: '运营企业列标题',
  ref: 'e1145'
})
```

```javascript
mcp__playwright__browser_wait_for({ time: 2 })
mcp__playwright__browser_snapshot()
```
**验证**: 运营企业信息排序功能

---

## C. 联系信息列排序测试

### C1. 联系人列排序测试

```javascript
// 点击联系人列标题
mcp__playwright__browser_click({
  element: '联系人列标题',
  ref: 'e1150'
})
```

```javascript
mcp__playwright__browser_wait_for({ time: 2 })
mcp__playwright__browser_snapshot()
```
**验证**: 联系人姓名排序

### C2. 联系电话列排序测试

```javascript
// 点击联系电话列标题
mcp__playwright__browser_click({
  element: '联系电话列标题',
  ref: 'e1155'
})
```

```javascript
mcp__playwright__browser_wait_for({ time: 2 })
mcp__playwright__browser_snapshot()
```
**验证**: 电话号码数字排序

---

## D. 地址信息列排序测试

### D1. 省份列排序测试

```javascript
// 点击省份列标题
mcp__playwright__browser_click({
  element: '省份列标题',
  ref: 'e1160'
})
```

```javascript
mcp__playwright__browser_wait_for({ time: 2 })
mcp__playwright__browser_snapshot()
```
**验证**: 省份地理信息排序

### D2. 城市列排序测试

```javascript
// 点击城市列标题
mcp__playwright__browser_click({
  element: '城市列标题',
  ref: 'e1165'
})
```

```javascript
mcp__playwright__browser_wait_for({ time: 2 })
mcp__playwright__browser_snapshot()
```
**验证**: 城市信息排序

### D3. 区域列排序测试

```javascript
// 点击区域列标题
mcp__playwright__browser_click({
  element: '区域列标题',
  ref: 'e1170'
})
```

```javascript
mcp__playwright__browser_wait_for({ time: 2 })
mcp__playwright__browser_snapshot()
```
**验证**: 区域信息排序

### D4. 详细地址列排序测试

```javascript
// 点击详细地址列标题
mcp__playwright__browser_click({
  element: '详细地址列标题',
  ref: 'e1175'
})
```

```javascript
mcp__playwright__browser_wait_for({ time: 2 })
mcp__playwright__browser_snapshot()
```
**验证**: 详细地址文本排序

---

## E. 数值类型列排序测试

### E1. 面积列排序测试

```javascript
// 点击面积列标题
mcp__playwright__browser_click({
  element: '面积列标题',
  ref: 'e1190'
})
```

```javascript
mcp__playwright__browser_wait_for({ time: 2 })
mcp__playwright__browser_snapshot()
```
**验证重点**:
- 数值类型排序（非字符串排序）
- 空值处理正确
- 数值大小关系正确

```javascript
// 测试降序排序
mcp__playwright__browser_click({
  element: '面积列标题',
  ref: 'e1190'
})
```

```javascript
mcp__playwright__browser_wait_for({ time: 2 })
mcp__playwright__browser_snapshot()
```
**验证**: 面积数值降序排序正确

### E2. 仓储容量列排序测试

```javascript
// 点击仓储容量列标题
mcp__playwright__browser_click({
  element: '仓储容量列标题',
  ref: 'e1195'
})
```

```javascript
mcp__playwright__browser_wait_for({ time: 2 })
mcp__playwright__browser_snapshot()
```
**验证**: 仓储容量数值排序功能

---

## F. 时间日期列排序测试

### F1. 创建时间列排序测试

```javascript
// 点击创建时间列标题
mcp__playwright__browser_click({
  element: '创建时间列标题',
  ref: 'e1207'
})
```

```javascript
mcp__playwright__browser_wait_for({ time: 2 })
mcp__playwright__browser_snapshot()
```
**验证重点**:
- 日期时间格式排序正确
- 时间顺序逻辑正确（最早到最晚）
- 日期显示格式保持一致

```javascript
// 测试降序排序（最新到最早）
mcp__playwright__browser_click({
  element: '创建时间列标题',
  ref: 'e1207'
})
```

```javascript
mcp__playwright__browser_wait_for({ time: 2 })
mcp__playwright__browser_snapshot()
```
**验证**: 时间降序排列（最新记录在前）

### F2. 修改时间列排序测试

```javascript
// 点击修改时间列标题
mcp__playwright__browser_click({
  element: '修改时间列标题',
  ref: 'e1217'
})
```

```javascript
mcp__playwright__browser_wait_for({ time: 2 })
mcp__playwright__browser_snapshot()
```
**验证**: 修改时间排序功能

---

## G. 用户信息列排序测试

### G1. 创建人列排序测试

```javascript
// 点击创建人列标题
mcp__playwright__browser_click({
  element: '创建人列标题',
  ref: 'e1202'
})
```

```javascript
mcp__playwright__browser_wait_for({ time: 2 })
mcp__playwright__browser_snapshot()
```
**验证**: 创建人姓名排序

### G2. 修改人列排序测试

```javascript
// 点击修改人列标题
mcp__playwright__browser_click({
  element: '修改人列标题',
  ref: 'e1212'
})
```

```javascript
mcp__playwright__browser_wait_for({ time: 2 })
mcp__playwright__browser_snapshot()
```
**验证**: 修改人信息排序

---

## H. 排序稳定性和数据完整性测试

### H1. 连续排序稳定性测试

```javascript
// 快速连续点击同一列标题测试稳定性
mcp__playwright__browser_click({
  element: '仓库编码列标题',
  ref: 'e1123'
})
```

```javascript
mcp__playwright__browser_wait_for({ time: 1 })
mcp__playwright__browser_click({
  element: '仓库编码列标题',
  ref: 'e1123'
})
```

```javascript
mcp__playwright__browser_wait_for({ time: 1 })
mcp__playwright__browser_click({
  element: '仓库编码列标题',
  ref: 'e1123'
})
```

```javascript
mcp__playwright__browser_wait_for({ time: 2 })
mcp__playwright__browser_snapshot()
```
**验证**: 连续点击后排序状态稳定，无异常错误

### H2. 跨列排序切换测试

```javascript
// 仓库编码排序
mcp__playwright__browser_click({
  element: '仓库编码列标题',
  ref: 'e1123'
})
```

```javascript
mcp__playwright__browser_wait_for({ time: 1 })
// 立即切换到仓库名称排序
mcp__playwright__browser_click({
  element: '仓库名称列标题',
  ref: 'e1128'
})
```

```javascript
mcp__playwright__browser_wait_for({ time: 1 })
// 再切换到创建时间排序
mcp__playwright__browser_click({
  element: '创建时间列标题',
  ref: 'e1207'
})
```

```javascript
mcp__playwright__browser_wait_for({ time: 2 })
mcp__playwright__browser_snapshot()
```
**验证重点**:
- 只有当前排序列显示排序指示器
- 之前的排序指示器正确清除
- 数据按最后一次点击的列正确排序

### H3. 分页环境下排序测试

```javascript
// 在有多页数据的情况下测试排序
mcp__playwright__browser_click({
  element: '仓库编码列标题',
  ref: 'e1123'
})
```

```javascript
mcp__playwright__browser_wait_for({ time: 2 })
mcp__playwright__browser_snapshot()
```
**验证**: 排序后当前页显示的是整个数据集排序后的前N条

```javascript
// 切换到第2页查看排序连续性
mcp__playwright__browser_click({
  element: '下一页按钮',
  ref: 'e1948'
})
```

```javascript
mcp__playwright__browser_wait_for({ time: 2 })
mcp__playwright__browser_snapshot()
```
**验证**: 第2页数据与第1页数据在排序上连续，保持整体排序逻辑

```javascript
// 回到第1页
mcp__playwright__browser_click({
  element: '上一页按钮',
  ref: 'e1938'
})
```

---

## I. 最终验证和清理

### I1. 控制台错误检查

```javascript
mcp__playwright__browser_console_messages()
```
**预期**: 无严重错误信息，特别是排序相关的JavaScript错误

### I2. 最终状态重置

```javascript
// 点击仓库编码列恢复默认排序
mcp__playwright__browser_click({
  element: '仓库编码列标题',
  ref: 'e1123'
})
```

```javascript
mcp__playwright__browser_wait_for({ time: 2 })
mcp__playwright__browser_snapshot()
```
**验证**: 页面恢复到稳定的排序状态

---

## 📊 排序功能测试结果记录

**测试执行时间**: [填写]  
**执行人**: [填写]  
**测试数据量**: [记录测试时的数据总数]

### ✅ 排序功能验证清单

#### A. 主要业务列排序
- [ ] A1. 仓库编码排序 (升序/降序)
- [ ] A2. 仓库名称排序 (中文排序)
- [ ] A3. 仓库简称排序

#### B. 企业信息列排序  
- [ ] B1. 监管企业排序
- [ ] B2. 运营企业排序

#### C. 联系信息列排序
- [ ] C1. 联系人排序
- [ ] C2. 联系电话排序

#### D. 地址信息列排序
- [ ] D1. 省份排序
- [ ] D2. 城市排序  
- [ ] D3. 区域排序
- [ ] D4. 详细地址排序

#### E. 数值类型列排序
- [ ] E1. 面积排序 (数值排序)
- [ ] E2. 仓储容量排序 (数值排序)

#### F. 时间日期列排序
- [ ] F1. 创建时间排序 (日期时间排序)
- [ ] F2. 修改时间排序 (日期时间排序)

#### G. 用户信息列排序
- [ ] G1. 创建人排序
- [ ] G2. 修改人排序

#### H. 排序稳定性测试
- [ ] H1. 连续排序稳定性
- [ ] H2. 跨列排序切换
- [ ] H3. 分页环境下排序

### ❌ 发现的排序问题
[记录排序相关问题和error目录中的截图文件名]

**常见问题检查**:
- [ ] 数值列是否按字符串排序（错误）
- [ ] 日期格式排序是否正确
- [ ] 中文排序是否符合预期
- [ ] 空值处理是否合理
- [ ] 排序指示器显示是否准确

### 🎯 排序功能总体评估

**排序功能状态**: [完全正常/部分问题/严重问题]  
**数据完整性**: [保持完整/有丢失]  
**性能表现**: [流畅/<2秒/较慢]  
**用户体验**: [优秀/良好/需改进]

**建议**:
- [针对发现问题的改进建议]
- [性能优化建议]  
- [用户体验改进建议]

---

## 测试说明

### 排序测试覆盖范围

本测试全面验证了仓库管理页面数据表格的排序功能：

1. **数据类型覆盖**: 文本、数值、日期、中文等各种数据类型的排序
2. **排序方向**: 每个可排序列的升序和降序功能  
3. **UI交互**: 排序指示器的显示和切换
4. **数据完整性**: 排序前后数据量和内容的一致性
5. **稳定性**: 连续操作和跨列切换的稳定性
6. **分页兼容**: 排序功能与分页的配合

### 排序测试要点

**数据类型处理**:
- 数值列应按数值大小排序，非字符串排序
- 日期时间列应按时间先后排序
- 中文文本应按合理的中文排序规则
- 空值的处理应统一且合理

**用户体验**:
- 排序操作响应迅速（<2秒）
- 排序指示器清晰准确
- 排序状态在页面刷新前保持
- 支持在不同列之间灵活切换排序

**系统稳定性**:
- 大数据量下排序不卡顿
- 连续快速点击不出错
- 分页导航不影响排序状态
- 排序操作不产生JavaScript错误

每个排序操作都遵循 **点击列标题 → 等待响应 → 截图验证 → 数据验证** 的完整测试流程，确保排序功能的可靠性和用户体验。